#include <stdio.h>

// Function to calculate factorial using a loop (iterative approach)
long long calculateFactorial(int n) {
    int i;
    long long factorial = 1;  // Initialize result to 1 (neutral for multiplication)

    // Loop from 1 to n, multiplying each number into factorial
    for (i = 1; i <= n; i++) {
        factorial = factorial * i;
        printf("  Step %d: factorial = %lld x %d = %lld\n", i, factorial / i, i, factorial);
    }

    return factorial;
}

// Function to validate input
int isValidInput(int n) {
    if (n < 0) {
        printf("\nError! Factorial is not defined for negative numbers.\n");
        return 0;  // Invalid
    }
    return 1;  // Valid
}

// Function to display result
void displayResult(int n, long long result) {
    printf("\n-------------------------------\n");
    printf("  Factorial of %d = %lld\n", n, result);
    printf("-------------------------------\n");
}

int main() {
    int n;
    long long result;
    char choice;

    printf("========================================\n");
    printf("   FACTORIAL CALCULATOR (No Recursion)  \n");
    printf("========================================\n");

    do {
        printf("\nEnter a non-negative integer: ");
        scanf("%d", &n);

        // Validate the input
        if (!isValidInput(n)) {
            printf("Please enter a valid number.\n");
        } else {
            // Special case: 0! = 1 by mathematical definition
            if (n == 0) {
                printf("\n0! = 1 (Special case: Factorial of 0 is always 1)\n");
            } else {
                printf("\nCalculating Factorial of %d step-by-step:\n\n", n);
                result = calculateFactorial(n);
                displayResult(n, result);
            }
        }

        printf("\nDo you want to calculate another factorial? (y/n): ");
        scanf(" %c", &choice);

    } while (choice == 'y' || choice == 'Y');

    printf("\nThank you for using Factorial Calculator!\n");

    return 0;
}
